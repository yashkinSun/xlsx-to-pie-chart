# Анализатор несоответствий на производстве

Приложение для анализа данных о несоответствиях на производстве с визуализацией результатов в виде многоуровневой круговой диаграммы и таблиц.

## Описание

Приложение позволяет:
- Загружать данные о несоответствиях из Excel-файлов
- Анализировать данные по ролям и отделам (Производство и Офис)
- Визуализировать результаты в виде многоуровневой круговой диаграммы
- Отображать таблицу ролей, отсортированную по трудозатратам
- Сравнивать данные с предыдущим месяцем
- Создавать отчеты Excel с исходными данными, сводкой и диаграммой

## Требования

- Python 3.8 или выше
- Библиотеки:
  - tkinter (для GUI)
  - pandas (для обработки данных)
  - matplotlib (для визуализации)
  - openpyxl (для работы с Excel)

## Установка

1. Установите Python 3.8 или выше с официального сайта: https://www.python.org/downloads/
2. Установите необходимые библиотеки:

```bash
pip install pandas matplotlib openpyxl
```

Tkinter обычно поставляется вместе с Python для Windows. Если его нет, установите его:

```bash
pip install tk
```

## Структура проекта

- `main.py` - Точка входа в приложение
- `app.py` - Основной класс приложения с GUI
- `data_loader.py` - Модуль для загрузки данных из Excel
- `data_analyzer.py` - Модуль для анализа данных
- `data_visualizer.py` - Модуль для визуализации данных
- `History/` - Папка для хранения истории загруженных файлов

## Запуск приложения

```bash
python main.py
```

## Использование

1. Нажмите кнопку "Загрузить Excel файл" и выберите файл с данными о несоответствиях
2. После загрузки файла будет отображена круговая диаграмма и таблица с результатами анализа
3. Для сравнения с предыдущим месяцем установите флажок "Сравнить с предыдущим месяцем"
4. Для создания отчета нажмите кнопку "Скачать отчет (.xlsx)"

## Формат данных

Приложение ожидает Excel-файл со следующими столбцами:
- "Виновник (Производство )" - роли производства
- "Виновник (Офис )" - роли офиса
- "Трудозатраты (рублей)" - трудозатраты в рублях

Роли могут быть разделены символом "/" (например, "Программист/Конструктор"). В этом случае трудозатраты будут разделены поровну между ролями.

## Создание исполняемого файла (.exe)

Для создания исполняемого файла для Windows используйте PyInstaller:

1. Установите PyInstaller:

```bash
pip install pyinstaller
```

2. Создайте исполняемый файл:

```bash
pyinstaller --onefile --windowed main.py
```

3. Исполняемый файл будет создан в папке `dist/`

Альтернативно, вы можете использовать Visual Studio 2022 для создания исполняемого файла:

1. Установите Visual Studio 2022 с поддержкой Python
2. Откройте проект в Visual Studio
3. Выберите меню "Проект" -> "Опубликовать" и следуйте инструкциям мастера

## Тестирование

Для проверки работоспособности приложения запустите тестовый скрипт:

```bash
python test_app.py
```

## Примечания

- Все загруженные файлы автоматически сохраняются в папку "History" с временной меткой
- При сравнении с предыдущим месяцем используется самый последний файл из папки "History"
- Отчет Excel содержит три листа: исходные данные, сводку и диаграмму
